<h2 mat-dialog-title>{{loc("title_params")}}</h2>
<mat-dialog-content class="dialog-style">
  <mat-tab-group>
    <mat-tab label="{{loc('tabFilter')}}">
      <br/>
      <mat-chip-option (selectionChange)="onPosProfitChange ($event)" [selected]="options.filterConfig.enablePosProfit">{{loc("positiveProfit")}}</mat-chip-option>
      <mat-chip-option (selectionChange)="onOldVsNewChange  ($event)" [selected]="options.filterConfig.enableOldNew"   >{{loc("oldVsNewPeriod")}}</mat-chip-option>
      <mat-chip-option (selectionChange)="onWinPercChange   ($event)" [selected]="options.filterConfig.enableWinPerc"  >{{loc("winningPerc")}}</mat-chip-option>
      <mat-chip-option (selectionChange)="onEquVsAvgChange  ($event)" [selected]="options.filterConfig.enableEquAvg"   >{{loc("equityVsAverage")}}</mat-chip-option>
      <mat-chip-option (selectionChange)="onTrendlineChange ($event)" [selected]="options.filterConfig.enableTrendline">{{loc("trendline")}}</mat-chip-option>

      <table>
        <tr>
          <th>{{loc("selected")}}</th>
          <th>{{loc("filter")}}</th>
          <th>{{loc("parameter")}}</th>
          <th>{{loc("options")}}</th>
        </tr>

        <!-- Prositive profit: days - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enablePosProfit">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.posProLen.toggle() : null"
                          [checked]="options.filterConfig.posProLen.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("positiveProfit")}}</td>
          <td>{{loc("length")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.posProLen.enabled" [(value)]="options.filterConfig.posProLen.curValue" [label]="loc('curValue')" [min]="1" [max]="300"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.posProLen.enabled" [(value)]="options.filterConfig.posProLen.minValue" [label]="loc('minValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.posProLen.enabled" [(value)]="options.filterConfig.posProLen.maxValue" [label]="loc('maxValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.posProLen.enabled" [(value)]="options.filterConfig.posProLen.step"     [label]="loc('step')"     [min]="1" [max]="300"></input-number-required>
          </td>
        </tr>

        <!-- Old vs new period: old len - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableOldNew">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.oldNewOldLen.toggle() : null"
                          [checked]="options.filterConfig.oldNewOldLen.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("oldVsNewPeriod")}}</td>
          <td>{{loc("oldLen")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.oldNewOldLen.enabled" [(value)]="options.filterConfig.oldNewOldLen.curValue" [label]="loc('curValue')" [min]="1" [max]="600"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewOldLen.enabled" [(value)]="options.filterConfig.oldNewOldLen.minValue" [label]="loc('minValue')" [min]="1" [max]="600"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewOldLen.enabled" [(value)]="options.filterConfig.oldNewOldLen.maxValue" [label]="loc('maxValue')" [min]="1" [max]="600"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewOldLen.enabled" [(value)]="options.filterConfig.oldNewOldLen.step"     [label]="loc('step')"     [min]="1" [max]="600"></input-number-required>
          </td>
        </tr>

        <!-- Old vs new period: new len - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableOldNew">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.oldNewNewLen.toggle() : null"
                          [checked]="options.filterConfig.oldNewNewLen.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("oldVsNewPeriod")}}</td>
          <td>{{loc("newLen")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.oldNewNewLen.enabled" [(value)]="options.filterConfig.oldNewNewLen.curValue" [label]="loc('curValue')" [min]="1" [max]="300"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewNewLen.enabled" [(value)]="options.filterConfig.oldNewNewLen.minValue" [label]="loc('minValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewNewLen.enabled" [(value)]="options.filterConfig.oldNewNewLen.maxValue" [label]="loc('maxValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewNewLen.enabled" [(value)]="options.filterConfig.oldNewNewLen.step"     [label]="loc('step')"     [min]="1" [max]="300"></input-number-required>
          </td>
        </tr>

        <!-- Old vs new period: old percentage - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableOldNew">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.oldNewOldPerc.toggle() : null"
                          [checked]="options.filterConfig.oldNewOldPerc.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("oldVsNewPeriod")}}</td>
          <td>{{loc("oldPerc")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.oldNewOldPerc.enabled" [(value)]="options.filterConfig.oldNewOldPerc.curValue" [label]="loc('curValue')" [min]="1" [max]="150"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewOldPerc.enabled" [(value)]="options.filterConfig.oldNewOldPerc.minValue" [label]="loc('minValue')" [min]="1" [max]="150"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewOldPerc.enabled" [(value)]="options.filterConfig.oldNewOldPerc.maxValue" [label]="loc('maxValue')" [min]="1" [max]="150"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.oldNewOldPerc.enabled" [(value)]="options.filterConfig.oldNewOldPerc.step"     [label]="loc('step')"     [min]="1" [max]="150"></input-number-required>
          </td>
        </tr>

        <!-- Winning percentage: len - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableWinPerc">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.winPercLen.toggle() : null"
                          [checked]="options.filterConfig.winPercLen.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("winningPerc")}}</td>
          <td>{{loc("length")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.winPercLen.enabled" [(value)]="options.filterConfig.winPercLen.curValue" [label]="loc('curValue')" [min]="1" [max]="300"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.winPercLen.enabled" [(value)]="options.filterConfig.winPercLen.minValue" [label]="loc('minValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.winPercLen.enabled" [(value)]="options.filterConfig.winPercLen.maxValue" [label]="loc('maxValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.winPercLen.enabled" [(value)]="options.filterConfig.winPercLen.step"     [label]="loc('step')"     [min]="1" [max]="300"></input-number-required>
          </td>
        </tr>

        <!-- Winning percentage: percentage - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableWinPerc">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.winPercPerc.toggle() : null"
                          [checked]="options.filterConfig.winPercPerc.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("winningPerc")}}</td>
          <td>{{loc("percentage")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.winPercPerc.enabled" [(value)]="options.filterConfig.winPercPerc.curValue" [label]="loc('curValue')" [min]="1" [max]="100"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.winPercPerc.enabled" [(value)]="options.filterConfig.winPercPerc.minValue" [label]="loc('minValue')" [min]="1" [max]="100"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.winPercPerc.enabled" [(value)]="options.filterConfig.winPercPerc.maxValue" [label]="loc('maxValue')" [min]="1" [max]="100"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.winPercPerc.enabled" [(value)]="options.filterConfig.winPercPerc.step"     [label]="loc('step')"     [min]="1" [max]="100"></input-number-required>
          </td>
        </tr>

        <!-- Equity vs average: len - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableEquAvg">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.equAvgLen.toggle() : null"
                          [checked]="options.filterConfig.equAvgLen.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("equityVsAverage")}}</td>
          <td>{{loc("length")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.equAvgLen.enabled" [(value)]="options.filterConfig.equAvgLen.curValue" [label]="loc('curValue')" [min]="1" [max]="300"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.equAvgLen.enabled" [(value)]="options.filterConfig.equAvgLen.minValue" [label]="loc('minValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.equAvgLen.enabled" [(value)]="options.filterConfig.equAvgLen.maxValue" [label]="loc('maxValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.equAvgLen.enabled" [(value)]="options.filterConfig.equAvgLen.step"     [label]="loc('step')"     [min]="1" [max]="300"></input-number-required>
          </td>
        </tr>

        <!-- Trendline: len - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableTrendline">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.trendlineLen.toggle() : null"
                          [checked]="options.filterConfig.trendlineLen.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("trendline")}}</td>
          <td>{{loc("length")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.trendlineLen.enabled" [(value)]="options.filterConfig.trendlineLen.curValue" [label]="loc('curValue')" [min]="1" [max]="300"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.trendlineLen.enabled" [(value)]="options.filterConfig.trendlineLen.minValue" [label]="loc('minValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.trendlineLen.enabled" [(value)]="options.filterConfig.trendlineLen.maxValue" [label]="loc('maxValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.trendlineLen.enabled" [(value)]="options.filterConfig.trendlineLen.step"     [label]="loc('step')"     [min]="1" [max]="300"></input-number-required>
          </td>
        </tr>

        <!-- Trendline: value - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <tr *ngIf="options.filterConfig.enableTrendline">
          <td>
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? options.filterConfig.trendlineValue.toggle() : null"
                          [checked]="options.filterConfig.trendlineValue.enabled">
            </mat-checkbox>
          </td>
          <td>{{loc("trendline")}}</td>
          <td>{{loc("value")}}</td>
          <td>
            <input-number-required *ngIf="!options.filterConfig.trendlineValue.enabled" [(value)]="options.filterConfig.trendlineValue.curValue" [label]="loc('curValue')" [min]="1" [max]="300"></input-number-required>

            <input-number-required class ="value-style" *ngIf="options.filterConfig.trendlineValue.enabled" [(value)]="options.filterConfig.trendlineValue.minValue" [label]="loc('minValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.trendlineValue.enabled" [(value)]="options.filterConfig.trendlineValue.maxValue" [label]="loc('maxValue')" [min]="1" [max]="300"></input-number-required>
            <input-number-required class ="value-style" *ngIf="options.filterConfig.trendlineValue.enabled" [(value)]="options.filterConfig.trendlineValue.step"     [label]="loc('step')"     [min]="1" [max]="300"></input-number-required>
          </td>
        </tr>
      </table>
    </mat-tab>

    <mat-tab label="{{loc('tabAlgorithm')}}">
      <br/>
      <select-text-required [(key)]="options.fieldToOptimize" [label]="loc('optimizeFor')" keyField="id" valueField="name" [list]="labelMap('fieldOptions')" class="field-to-optimize"></select-text-required>
      <select-text-required [(key)]="options.algorithm.type"  [label]="loc('algorithm')"   keyField="id" valueField="name" [list]="labelMap('algorOptions')" class="field-to-optimize"></select-text-required>

    </mat-tab>
  </mat-tab-group>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onReset()">{{button("reset")}}</button>
  <button mat-button (click)="onRun()">{{button("run")}}</button>
  <button mat-button mat-dialog-close>{{button("cancel")}}</button>
</mat-dialog-actions>
